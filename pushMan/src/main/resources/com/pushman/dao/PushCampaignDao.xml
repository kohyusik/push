<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pushman.dao.PushCampaignDao">

	<resultMap type="PushCampaignVo" id="PushCampaignVoMap">
		<id 	column="camp_id" 			property="camp_id" />
		<result column="push_camp_title"  	property="push_camp_title" />
		<result column="push_title"  		property="push_title" />
		<result column="push_msg"  			property="push_msg" />
		<result column="popup_content"  	property="popup_content" />
		<result column="inapp_content"  	property="inapp_content" />
		<result column="reg_date"  			property="reg_date" />
		<result column="push_total" 		property="push_total" />
		<result column="push_succ" 	  		property="push_succ" />
		<result column="push_wait" 	  		property="push_wait" />
		<result column="push_fail"   		property="push_fail" />
		<result column="push_open" 	  		property="push_open" />
		<result column="push_click" 		property="push_click" />
		<result column="camp_reqUid" 		property="camp_reqUid" />
		<result column="user_no" 			property="user_no" />
	</resultMap>

	<select id="selectList" parameterType="map" resultMap="PushCampaignVoMap">
		SELECT
			camp_id, push_camp_title, push_title, push_msg, popup_content, inapp_content,
			DATE_FORMAT(reg_date, '%Y-%m-%d %H:%i:%S') reg_date,
			push_total, push_succ, push_wait, push_fail, push_open, push_click,
			camp_reqUid, user_no
		FROM PUSH_CAMPAIGN
	</select>
	
	<select id="selectListByPusher" parameterType="map" resultMap="PushCampaignVoMap">
		SELECT
			camp_id, push_camp_title, push_title, push_msg, popup_content, inapp_content,
			DATE_FORMAT(reg_date, '%Y-%m-%d %H:%i:%S') reg_date,
			push_total, push_succ, push_wait, push_fail, push_open, push_click,
			camp_reqUid, user_no
		FROM PUSH_CAMPAIGN
		WHERE user_no=${user_no}
	</select>

	<insert id="insert" parameterType="PushCampaignVo" keyColumn="camp_id"
		keyProperty="camp_id" useGeneratedKeys="true">
		INSERT INTO PUSH_CAMPAIGN
			(push_camp_title, push_title, push_msg, popup_content, inapp_content,
			reg_date, push_total, push_succ, push_wait, push_fail, push_open, 
			push_click, user_no)
		VALUES (#{push_camp_title}, #{push_title}, #{push_msg}, #{popup_content}, #{inapp_content}, 
				SYSDATE(), 0, 0, 0, 0, 0, 0, #{user_no})
	</insert>
	
	
	<update id="updateInit" parameterType="PushCampaignVo" keyColumn="camp_id"
		keyProperty="camp_id" useGeneratedKeys="true">
		UPDATE PUSH_CAMPAIGN 
		SET push_total=${push_total}, camp_reqUid='${camp_reqUid}'
		WHERE camp_id=${camp_id}
	</update>


</mapper>









